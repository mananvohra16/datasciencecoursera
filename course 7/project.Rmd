---
title: "project"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


Project Instructions

You work for Motor Trend, a magazine about the automobile industry. Looking at a data set of a collection of cars, they are interested in exploring the relationship between a set of variables and miles per gallon (MPG) (outcome). They are particularly interested in the following two questions:

    “Is an automatic or manual transmission better for MPG”
    "Quantify the MPG difference between automatic and manual transmissions"  


Loading mtcars dataset

```{r}
data("mtcars")
head(mtcars)
```

Analysis

```{r}
library(ggplot2)
library(dplyr)
```

Exploring relationship between transmission and MPG

```{r}
mpg_vs_am <- mtcars %>% select(mpg, am) %>% mutate(am = as.factor(am))
ggplot(data = mpg_vs_am, aes(x=am  , y=mpg))+
  geom_boxplot() + geom_point()+
  xlab("Transmission: 0 - Manual   1 - Automatic")+
  ylab("Mpg")
```
Modeling

```{r}
data <- mtcars %>% mutate( 
                    cyl = as.factor(cyl),
                    vs = as.factor(vs),
                    am = as.factor(am),
                    gear = as.factor(am),
                    carb = as.factor(carb))

fit_all <- lm(mpg ~. , data = data)
summary(fit_all)$coef[,4]
```
As none of the variables have a p-value less than 5%, we would have to remove most insignificant variables one by one.

```{r}

which.max(summary(fit_all)$coef[,4])

```
```{r}
data <- data %>% select(-carb)
fit <- lm(mpg ~. , data = data)
summary(fit)$coef[,4]
which.max(summary(fit)$coef[,4])
```
we now have on significant variable which is wt and we will continue this process to come up with the signifiacnt variables
```{r}
data <- data %>% select(-cyl); fit <- lm(mpg ~. , data = data); summary(fit)$coef[,4]; which.max(summary(fit)$coef[,4])

data <- data %>% select(-vs); fit <- lm(mpg ~. , data = data); summary(fit)$coef[,4]; which.max(summary(fit)$coef[,4])

data <- data %>% select(-drat); fit <- lm(mpg ~. , data = data); summary(fit)$coef[,4]; which.max(summary(fit)$coef[,4])

data <- data %>% select(-disp); fit <- lm(mpg ~. , data = data); summary(fit)$coef[,4]; which.max(summary(fit)$coef[,4])

data <- data %>% select(-hp); fit <- lm(mpg ~. , data = data); summary(fit)$coef[,4]; which.max(summary(fit)$coef[,4])
```

No we have only significant variables which are wt, qsec, am
```{r}
summary(fit)
```



```{r}
par(mfrow = c(2, 2))
plot(fit)
```

The QQ plot shows a pretty good correlation of the standardized and theoretical residuals. There also doesn’t seem to be any significant patterns in the other three plots, indicating a good fit of the selected model



Conclusion

we can conclude that if weight and 1/4 mile time are same for the two transmission, the manual transmission car will have 2.9358 higher miles/gallon than the automatic transmission car.
